<?xml version="1.0"?>
<robot xmlns:xacro="http://ros.org/wiki/xacro">

<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
  <xacro:include filename="$(find neo_description)/urdf/omni_6/omni_6.transmission.xacro" />
  <xacro:include filename="$(find neo_description)/urdf/omni_6/omni_6.gazebo.xacro" />

<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
  <xacro:macro name="omni_6_robot" params="
    first_lower_limit:=${-2.0*pi/3.0}     first_upper_limit:=${2.0*pi/3.0}
    second_lower_limit:=${-pi/2.0}        second_upper_limit:=${pi/2.0}
    third_lower_limit:=${-5.0*pi/9.0}     third_upper_limit:=${5.0*pi/9.0}
    fourth_lower_limit:=${-8.5*pi/9.0}    fourth_upper_limit:=${8.5*pi/9.0}
    fifth_lower_limit:=${-5.0*pi/9.0}     fifth_upper_limit:=${5.0*pi/9.0}
    sixth_lower_limit:=${-8.5*pi/9.0}     sixth_upper_limit:=${8.5*pi/9.0}">
    
<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
  <xacro:macro name="link_material" params="name">
    <material name="${name}">
      <color rgba="0.75294 0.75294 0.75294 1" />
    </material>
  </xacro:macro>

  <xacro:macro name="link_geometry" params="name">
    <geometry>
      <mesh filename="package://neo_description/meshes/omni_6/${name}.stl" />
    </geometry>
  </xacro:macro>

  <xacro:macro name="cylinder_inertial" params="radius length mass">
    <inertial>
      <mass value="${mass}" />
      <origin xyz="0.0 0.0 0.0" rpy="0 0 0" />
      <inertia  ixx="${1.0 / 12 * mass * (3 * radius * radius + length * length)}" ixy="0.0" ixz="0.0"
                iyy="${1.0 / 12 * mass * (3 * radius * radius + length * length)}" iyz="0.0"
                izz="${0.5 * mass * radius * radius}" />
    </inertial>
  </xacro:macro>

<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
    <link name="base_link" >
      <visual>
        <xacro:link_geometry name="base_link" />
        <xacro:link_material name="LightGrey" />
      </visual>
      <collision>
        <xacro:link_geometry name="base_link" />
      </collision>
      <xacro:cylinder_inertial radius="0.0700" length="0.1565" mass="23.943" />
    </link>
    
<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
    <joint name="first_joint" type="revolute">
      <parent link="base_link" />
      <child link="first_link" />
      <origin xyz="0 0 0.1565" rpy="0 0 0" />
      <axis xyz="0 0 1" />
      <limit lower="${first_lower_limit}" upper="${first_upper_limit}" effort="100.0" velocity="100.0"/>
    </joint>

<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
    <link name="first_link">
      <visual>
        <xacro:link_geometry name="first_link" />
        <xacro:link_material name="LightGrey" />
      </visual>
      <collision>
        <xacro:link_geometry name="first_link" />
      </collision>
      <xacro:cylinder_inertial radius="0.050" length="0.0380" mass="0.77157" />
    </link>

<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
    <joint name="second_joint" type="revolute">
      <parent link="first_link" />
      <child link="second_link" />
      <origin xyz="0.038 0 0.07" rpy="1.57 0 -1.57" />
      <axis xyz="0 0 1" />
      <limit lower="${second_lower_limit}" upper="${second_upper_limit}" effort="100.0" velocity="100.0"/>
    </joint>

<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
    <link name="second_link">
      <visual>
        <xacro:link_geometry name="second_link" />
        <xacro:link_material name="LightGrey" />
      </visual>
      <collision>
        <xacro:link_geometry name="second_link" />
      </collision>
      <xacro:cylinder_inertial radius="0.0500" length="0.29" mass="1.3093" />
    </link>

<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
    <joint name="third_joint" type="revolute">
      <parent link="second_link" />
      <child link="third_link" />
      <origin xyz="0 0.29 0.036" rpy="-3.1416 0 0" />
      <axis xyz="0 0 -1" />
      <limit lower="${third_lower_limit}" upper="${third_upper_limit}" effort="100.0" velocity="100.0"/>
    </joint>

<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
    <link name="third_link">
      <visual>
        <xacro:link_geometry name="third_link" />
        <xacro:link_material name="LightGrey" />
      </visual>
      <collision>
        <xacro:link_geometry name="third_link" />
      </collision>
      <xacro:cylinder_inertial radius="0.0500" length="0.1190" mass="0.53063" />
    </link>

<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
    <joint name="fourth_joint" type="revolute">
      <parent link="third_link" />
      <child link="fourth_link" />
      <origin xyz="0 -0.119 -0.0025" rpy="1.5708 -1.5708 0" />
      <axis xyz="0 0 1" />
      <limit lower="${fourth_lower_limit}" upper="${fourth_upper_limit}" effort="100.0" velocity="100.0"/>
    </joint>

<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
    <link name="fourth_link">
      <visual>
        <xacro:link_geometry name="fourth_link" />
        <xacro:link_material name="LightGrey" />
      </visual>
      <collision>
        <xacro:link_geometry name="fourth_link" />
      </collision>
      <xacro:cylinder_inertial radius="0.0500" length="0.1710" mass="0.826" />
    </link>

<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
    <joint name="fifth_joint" type="revolute">
      <parent link="fourth_link" />
      <child link="fifth_link" />
      <origin xyz="-0.0285 0 0.171" rpy="1.5708 0 -1.5708" />
      <axis xyz="0 0 1" />
      <limit lower="${fifth_lower_limit}" upper="${fifth_upper_limit}" effort="100.0" velocity="100.0"/>
    </joint>

<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
    <link name="fifth_link">
      <visual>
        <xacro:link_geometry name="fifth_link" />
        <xacro:link_material name="LightGrey" />
      </visual>
      <collision>
        <xacro:link_geometry name="fifth_link" />
      </collision>
      <xacro:cylinder_inertial radius="0.0500" length="0.0285" mass="0.26325" />
    </link>

<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
    <joint name="sixth_joint" type="revolute">
      <parent link="fifth_link" />
      <child link="sixth_link" />
      <origin xyz="0 0.0605 -0.0285" rpy="1.5708 1.5708 3.1416" />
      <axis xyz="0 0 1" />
      <limit lower="${sixth_lower_limit}" upper="${sixth_upper_limit}" effort="100.0" velocity="100.0"/>
    </joint>

<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
    <link name="sixth_link">
      <visual>
        <xacro:link_geometry name="sixth_link" />
        <xacro:link_material name="LightGrey" />
      </visual>
      <collision>
        <xacro:link_geometry name="sixth_link" />
      </collision>
      <xacro:cylinder_inertial radius="0.0500" length="0.0605" mass="0.26299" />
    </link>

<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
    <joint name="ee_flange_joint" type="fixed">
      <parent link="sixth_link" />
      <child link="ee_flange_link" />
      <origin xyz="0 0 0.0405" rpy="0 0 1.57" />
    </joint>

    <link name="ee_flange_link">
      <collision>
        <geometry>
          <box size="0.001 0.001 0.001"/>
        </geometry>
        <origin rpy="0 0 0" xyz="0 0 0"/>
      </collision>
    </link>

<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
    <xacro:omni_6_transmission />
    <xacro:omni_6_gazebo />

  </xacro:macro>
</robot>
